# キー入力
基本APIのGetAsyncKeyState()を利用する。

## 準備
コードの先頭に以下のusingを追加。

```cs
using System.Runtime.InteropServices;
```

クラス内に、user32.dllのインポートと、GetAsyncKeyState()の外部宣言を記載する。

```cs
[DllImport(“user32.dll”)]
public static extern short GetAsyncKeyState(int vKey);
```

## 仮想キーコードの定義
「GetAsyncKeyState(仮想キーコード);」で、指定のキーが押されているかを判定できる。引数に渡す仮想キーコードを以下に記載する(参考URL: http://homepage3.nifty.com/ic/help/rmfunc/vkey.htm )

代表的なキーコードを定義するプログラム。

```cs
        // 仮想キーコード / RETURNキー
        public const int VK_RETURN = 0x0D;
        // 仮想キーコード / エスケープキー
        public const int VK_ESCAPE = 0x1B;
        // 仮想キーコード / スペースキー
        public const int VK_SPACE = 0x20;
        // 仮想キーコード / 左キー
        public const int VK_LEFT = 0x25;
        // 仮想キーコード / 上キー
        public const int VK_UP = 0x26;
        // 仮想キーコード / 右キー
        public const int VK_RIGHT = 0x27;
        // 仮想キーコード / 下キー
        public const int VK_DOWN = 0x28;
        // 仮想キーコード / Z
        public const int VK_Z = 0x5A;
        // 仮想キーコード / X
        public const int VK_X = 0x58;
        // 仮想キーコード / C
        public const int VK_C = 0x43;
```

## 押されているかを判定する
スペースキーが押されているかのコード。

```cs
            if (GetAsyncKeyState(VK_SPACE) < 0)
            {
                Text = “space”;
            }
```

---

[前へ](16.md) | [目次へ](README.md#%E7%9B%AE%E6%AC%A1)
